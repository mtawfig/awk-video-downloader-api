const regexMatchAndReplace = (text, regex, replace) => {
  if(!text || !text.match) return;
  const candidates = text.match(regex);
  if(!candidates) return undefined;
  const formatted = candidates.map(candidate => {
    return candidate.replace(regex, replace);
  });
  return formatted;
}

const regexMatchAndReplaceOne = (text, regex, replace) => {
  const result = regexMatchAndReplace(text, regex, replace);
  return result && result[0] ? result[0] : null;
}

const formatInput = (input) => {
  try{
    const regex =  /(https:\/\/)?(www\.)?(facebook.com\/|fb.com\/)?(pg\/|pages\/)?(.*?)(\/.*?)?$/gi;
    const replace = '$5';
    const query = regexMatchAndReplaceOne(input, regex, replace);
    return {url: `https://www.facebook.com/pg/${query}/about`, normalised: query.toLowerCase()};
  }catch(e){
    return null;
  }
}

module.exports = formatInput;